<!-- <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  <link rel="stylesheet" type="text/css" href="style.css">
  <link href="https://fonts.googleapis.com/css?family=Dancing+Script|Source+Sans+Pro&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
</head>
<body>
  <div class=" position-relative" id="background">
    <div class="text-center display-2 text-white pt-1" style="font-family: 'Dancing Script';"> Recommender System </div>
    <div class="input-group mb-3 position-absolute col-md-4" style="top:50%;left:50%;transform:translate(-50%,-50%)">
      <input type="text" class="form-control " placeholder="Mời nhập UserID" aria-label="Recipient's username" aria-describedby="basic-addon2">
      <div class="input-group-append">
        <button class="btn btn-outline-secondary" style="color: #f8f9fa" type="button">OK</button>
      </div>
    </div>
  </div>

  <div class="recommend">
    <div class="fontsize text-uppercase pb-5 font-weight-bold pl-5" >Có thể bạn quan tâm</div>

  <div id="carouselExampleIndicators" class="carousel slide pl-5 pr-5 col-md-11 mx-auto pb-5" data-ride="carousel">
    <div class="carousel-inner">
    </div>
    <a class="bg-primary position-absolute" style="top:50%; left: 0; transform: translateY(50%)" href="#carouselExampleIndicators" role="button" data-slide="prev">
      <div class="btn bg-primary text-light">
        <i class="fas fa-chevron-left "></i>
      </div>
    </a>
    <a class="bg-primary position-absolute" style="top:50%; right: 0; transform: translateY(50%)" href="#carouselExampleIndicators" role="button" data-slide="next">
      <div class="btn bg-primary text-light">
        <i class="fas fa-chevron-right "></i>
      </div>
    </a>
  </div>
  </div>

<script>
  $(function(){
    var phim = [],
        i = 0,
        check = [],
        category = "",
        director = "",
        rating = "",
        title = "",
        stars = "";
    $.getJSON("http://127.0.0.1:5000/out" ,function(data){
      data.push(["a"]);
      $.map(data, function(v,i){
        var checktt = $.grep(check, function(n){
          return n == v[0];
        });
        if (checktt.length == 1){
          category += ", "+ v[3];
          director = v[1];
          rating = v[4];
          title = v[0];
          stars = v[2];
        }
        else {
          if (check.length == 0 ){
            check.push(v[0]);
            category = v[3];
            director = v[1];
            rating = v[4];
            title = v[0];
            stars = v[2];
          }
          else{
            phim.push({
              "title" : title,
              "director" : director,
              "stars" : stars,
              "category" : category,
              "rating" : rating,
            });
            check.push(v[0]);
            category = v[3];
            director = v[1];
            rating = v[4];
            title = v[0];
            stars = v[2];
          }
        }
      });
      for (var i = 0 ; i < 3; i++){
        $(".carousel-inner").append(
          $("<div>", { class: "carousel-item w-100 text-center " + ( i == 0 ? "active" : "")}).append(
            $.map([0,1,2,3], function(v){
              var n = v +4*i;
              return $("<div>", { class: "card col-md-3 d-inline-block mr-2 align-top position-relative"}).css({"width":"16rem", "height": "650px"}).append(
                $("<img>", { src: "http://image.phimmoi.net/film/8163/poster.medium.jpg", class:"card-img-top"}),
                $("<div>", { class: "card-body"}).append(
                  $("<h5>", { class: "card-title", text: "Phim: " + phim[n].title}),
                  $("<div>", { class: "card-text text-left", text: "- Đạo diễn: " + phim[n].director}),
                  $("<div>", { class: "card-text text-left", text: "- Diễn viên: " + phim[n].stars}),
                  $("<div>", { class: "card-text text-left", text: "- Thể loại: " + phim[n].category}),
                  $("<div>", { class: "card-text text-left position-absolute mb-2", text: "- Trung bình đánh giá: " + phim[n].rating}).css({"bottom":"0"}),
                ),
              );
            }),
          ),
        );
      }
    });
  });
</script>
</body>
</html> -->



<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
  <link rel="stylesheet" type="text/css" href="style.css">
  <link href="https://fonts.googleapis.com/css?family=Dancing+Script|Source+Sans+Pro&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
</head>
<body>
  <div class=" position-relative" id="background">
    <div class="text-center display-2 text-white pt-1" style="font-family: 'Dancing Script';"> Recommender System </div>
    <div class="input-group mb-3 position-absolute col-md-4" style="top:50%;left:50%;transform:translate(-50%,-50%)">
      <input type="text" class="form-control " name="userID" id="userID" placeholder="Mời nhập UserID" aria-label="Recipient's username" aria-describedby="basic-addon2">
      <div class="input-group-append">
        <button class="btn btn-outline-secondary" id="btnOK" style="color: #f8f9fa" type="button">OK</button>
      </div>
    </div>
  </div>

  <div class="recommend">
      <div class="fontsize text-uppercase pb-5 font-weight-bold pl-5" >Có thể bạn quan tâm</div>

      <div id="carouselRecommend" class="carousel slide pl-5 pr-5 col-md-11 mx-auto pb-5" data-ride="carousel">
        <div class="carousel-inner" id="recommend">
        </div>
        <a class="bg-primary position-absolute" style="top:50%; left: 0; transform: translateY(50%)" href="#carouselRecommend" role="button" data-slide="prev">
          <div class="btn bg-primary text-light">
            <i class="fas fa-chevron-left "></i>
          </div>
        </a>
        <a class="bg-primary position-absolute" style="top:50%; right: 0; transform: translateY(50%)" href="#carouselRecommend" role="button" data-slide="next">
          <div class="btn bg-primary text-light">
            <i class="fas fa-chevron-right "></i>
          </div>
        </a>
      </div>

      <div class="fontsize text-uppercase pb-5 font-weight-bold pl-5 mt-3" >Những phim bạn đã xem</div>

      <div id="carouselHistory" class="carousel slide pl-5 pr-5 col-md-11 mx-auto pb-5" data-ride="carousel">
        <div class="carousel-inner" id="history">
        </div>
        <a class="bg-primary position-absolute" style="top:50%; left: 0; transform: translateY(50%)" href="#carouselHistory" role="button" data-slide="prev">
          <div class="btn bg-primary text-light">
            <i class="fas fa-chevron-left "></i>
          </div>
        </a>
        <a class="bg-primary position-absolute" style="top:50%; right: 0; transform: translateY(50%)" href="#carouselHistory" role="button" data-slide="next">
          <div class="btn bg-primary text-light">
            <i class="fas fa-chevron-right "></i>
          </div>
        </a>
      </div>

  </div>

  <div class="modal" id="myModal">
    <div class="modal-dialog">
      <div class="modal-content">

        <!-- Modal Header -->
        <div class="modal-header">
          <h4 class="modal-title"></h4>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>

        <!-- Modal body -->
        <div class="modal-body">

        </div>

        <!-- Modal footer -->
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
        </div>

      </div>
    </div>
  </div>

<script>
  $(function(){
    var val;
    makeSlide = (data,phim,check,category,director,rating,title,stars,placeid) =>{
      console.log(data);
        data.push(["a"]);
        $.map(data, function(v,i){
          var checktt = $.grep(check, function(n){
            return n == v[0];
          });
          if (checktt.length == 1){
            category += ", "+ v[3];
            director = v[1];
            rating = v[4];
            title = v[0];
            stars = v[2];
          }
          else {
            if (check.length == 0 ){
              check.push(v[0]);
              category = v[3];
              director = v[1];
              rating = v[4];
              title = v[0];
              stars = v[2];
            }
            else{
              phim.push({
                "title" : title,
                "director" : director,
                "stars" : stars,
                "category" : category,
                "rating" : rating,
              });
              check.push(v[0]);
              category = v[3];
              director = v[1];
              rating = v[4];
              title = v[0];
              stars = v[2];
            }
          }
        });
        for (var i = 0 ; i < 3; i++){
          $("#"+ placeid).append(
            $("<div>", { class: "carousel-item w-100 text-center " + ( i == 0 ? "active" : "")}).append(
              $.map([0,1,2,3], function(v){
                var n = v +4*i;
                return $("<div>", { class: "card col-md-8 d-inline-block mr-2 align-top position-relative", id: "movie"}).css({"width":"250px", "height": "650px"}).append(
                  $("<img>", { src: "https://m.media-amazon.com/images/M/MV5BMzk2OTg4MTk1NF5BMl5BanBnXkFtZTcwNjExNTgzNA@@._V1_UX182_CR0,0,182,268_AL_.jpg", class:"card-img-top w-75"}),
                  $("<div>", { class: "card-body"}).append(
                    $("<h5>", { class: "card-title ", text: "Phim: " + phim[n].title}),

                    $("<div>", { class: "card-text text-left "}).append(
                      $("<div>", { class: " font-weight-bold d-inline", text: "Đạo diễn: "}),
                      $("<div>", {class: "d-inline", text: phim[n].director})
                    ),
                    $("<div>", { class: "card-text text-left mt-2"}).append(
                      $("<div>", { class: " font-weight-bold d-inline", text: "Diễn viên: "}),
                      $("<div>", {class: "d-inline", text: phim[n].stars})
                    ),

                    $("<div>", { class: "card-text text-left mt-2"}).append(
                      $("<div>", { class: " font-weight-bold d-inline", text: "Thể loại: "}),
                      $("<div>", {class: "d-inline", text: phim[n].category})
                    ),

                    $("<div>", { class: "card-text text-left position-absolute mb-3 mt-2"}).css({"bottom":"0"}).append(
                      $("<div>", { class: " font-weight-bold d-inline  ", text: "Đánh giá: "}),
                      $("<div>", {class: "d-inline ", text: phim[n].rating})
                    ),

                  ),
                ).on("click", function(){
                	console.log(phim[n]);
                });
              }),
            ),
          );
        }
      }
    $("#btnOK").click(function(){
    $("#recommend").children().remove();
    $("#history").children().remove();
    var phim = [],
        check = [],
        category = "",
        director = "",
        rating = "",
        title = "",
        stars = "",
        phimH = [],
        checkH = [],
        categoryH = "",
        directorH = "",
        ratingH = "",
        titleH = "",
        starsH = "";
    val = $("#userID").val();

      $.getJSON("http://127.0.0.1:5000/out", {data : val}, function(data){
        makeSlide(data,phim,check,category,director,rating,title,stars,"recommend");
      });

      $.getJSON("http://127.0.0.1:5000/history", {data : val}, function(data){
        makeSlide(data,phimH,checkH,categoryH,directorH,ratingH,titleH,starsH,"history");
      });
    });
    $("#movie").click(function(){

    });
  });

</script>
</body>
</html>
